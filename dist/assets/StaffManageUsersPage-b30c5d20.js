import{c as ut,r as l,q as Ce,s as z,j as t,t as B,v as ft,_ as mt,w as ht,x as W,y as vt,z as gt,A as pt,D as xt,E as bt,G as yt,H as jt,K as V,M as ge,N as Ct,O as Nt,Q as wt,T as Et,V as St,W as Rt,R as Z,a as H,X as Ae,u as Dt,h as _t,Y as q,Z as Tt,m as kt,C as Ft,$ as Pt,g as Ne,a0 as It,a1 as At,B as k,U as Ot,L as F,I as A,S as ee,b as te,d as ae,e as re,f as K,k as Mt,a2 as Lt,a3 as Ut,a4 as Wt,a5 as we,a6 as O,a7 as Bt,a8 as M,a9 as Ht,aa as $t,ab as qt}from"./index-c3095aca.js";import{u as se}from"./index-033623e7.js";const Vt=ut("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);var ne="focusScope.autoFocusOnMount",le="focusScope.autoFocusOnUnmount",Ee={bubbles:!1,cancelable:!0},Kt="FocusScope",Oe=l.forwardRef((e,a)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:d,onUnmountAutoFocus:c,...f}=e,[i,g]=l.useState(null),v=Ce(d),C=Ce(c),N=l.useRef(null),E=z(a,s=>g(s)),p=l.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;l.useEffect(()=>{if(n){let s=function(h){if(p.paused||!i)return;const x=h.target;i.contains(x)?N.current=x:T(N.current,{select:!0})},u=function(h){if(p.paused||!i)return;const x=h.relatedTarget;x!==null&&(i.contains(x)||T(N.current,{select:!0}))},m=function(h){if(document.activeElement===document.body)for(const j of h)j.removedNodes.length>0&&T(i)};document.addEventListener("focusin",s),document.addEventListener("focusout",u);const b=new MutationObserver(m);return i&&b.observe(i,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",s),document.removeEventListener("focusout",u),b.disconnect()}}},[n,i,p.paused]),l.useEffect(()=>{if(i){Re.add(p);const s=document.activeElement;if(!i.contains(s)){const m=new CustomEvent(ne,Ee);i.addEventListener(ne,v),i.dispatchEvent(m),m.defaultPrevented||(Yt(Jt(Me(i)),{select:!0}),document.activeElement===s&&T(i))}return()=>{i.removeEventListener(ne,v),setTimeout(()=>{const m=new CustomEvent(le,Ee);i.addEventListener(le,C),i.dispatchEvent(m),m.defaultPrevented||T(s??document.body,{select:!0}),i.removeEventListener(le,C),Re.remove(p)},0)}}},[i,v,C,p]);const w=l.useCallback(s=>{if(!r&&!n||p.paused)return;const u=s.key==="Tab"&&!s.altKey&&!s.ctrlKey&&!s.metaKey,m=document.activeElement;if(u&&m){const b=s.currentTarget,[h,x]=Gt(b);h&&x?!s.shiftKey&&m===x?(s.preventDefault(),r&&T(h,{select:!0})):s.shiftKey&&m===h&&(s.preventDefault(),r&&T(x,{select:!0})):m===b&&s.preventDefault()}},[r,n,p.paused]);return t.jsx(B.div,{tabIndex:-1,...f,ref:E,onKeyDown:w})});Oe.displayName=Kt;function Yt(e,{select:a=!1}={}){const r=document.activeElement;for(const n of e)if(T(n,{select:a}),document.activeElement!==r)return}function Gt(e){const a=Me(e),r=Se(a,e),n=Se(a.reverse(),e);return[r,n]}function Me(e){const a=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const d=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||d?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)a.push(r.currentNode);return a}function Se(e,a){for(const r of e)if(!Xt(r,{upTo:a}))return r}function Xt(e,{upTo:a}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(a!==void 0&&e===a)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function zt(e){return e instanceof HTMLInputElement&&"select"in e}function T(e,{select:a=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&zt(e)&&a&&e.select()}}var Re=Zt();function Zt(){let e=[];return{add(a){const r=e[0];a!==r&&(r==null||r.pause()),e=De(e,a),e.unshift(a)},remove(a){var r;e=De(e,a),(r=e[0])==null||r.resume()}}}function De(e,a){const r=[...e],n=r.indexOf(a);return n!==-1&&r.splice(n,1),r}function Jt(e){return e.filter(a=>a.tagName!=="A")}var oe=0;function Qt(){l.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??_e()),document.body.insertAdjacentElement("beforeend",e[1]??_e()),oe++,()=>{oe===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(a=>a.remove()),oe--}},[])}function _e(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Le=ft(),ie=function(){},J=l.forwardRef(function(e,a){var r=l.useRef(null),n=l.useState({onScrollCapture:ie,onWheelCapture:ie,onTouchMoveCapture:ie}),d=n[0],c=n[1],f=e.forwardProps,i=e.children,g=e.className,v=e.removeScrollBar,C=e.enabled,N=e.shards,E=e.sideCar,p=e.noRelative,w=e.noIsolation,s=e.inert,u=e.allowPinchZoom,m=e.as,b=m===void 0?"div":m,h=e.gapMode,x=mt(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),j=E,_=ht([r,a]),S=W(W({},x),d);return l.createElement(l.Fragment,null,C&&l.createElement(j,{sideCar:Le,removeScrollBar:v,shards:N,noRelative:p,noIsolation:w,inert:s,setCallbacks:c,allowPinchZoom:!!u,lockRef:r,gapMode:h}),f?l.cloneElement(l.Children.only(i),W(W({},S),{ref:_})):l.createElement(b,W({},S,{className:g,ref:_}),i))});J.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};J.classNames={fullWidth:vt,zeroRight:gt};var de=!1;if(typeof window<"u")try{var Y=Object.defineProperty({},"passive",{get:function(){return de=!0,!0}});window.addEventListener("test",Y,Y),window.removeEventListener("test",Y,Y)}catch{de=!1}var L=de?{passive:!1}:!1,ea=function(e){return e.tagName==="TEXTAREA"},Ue=function(e,a){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[a]!=="hidden"&&!(r.overflowY===r.overflowX&&!ea(e)&&r[a]==="visible")},ta=function(e){return Ue(e,"overflowY")},aa=function(e){return Ue(e,"overflowX")},Te=function(e,a){var r=a.ownerDocument,n=a;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var d=We(e,n);if(d){var c=Be(e,n),f=c[1],i=c[2];if(f>i)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},ra=function(e){var a=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[a,r,n]},sa=function(e){var a=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[a,r,n]},We=function(e,a){return e==="v"?ta(a):aa(a)},Be=function(e,a){return e==="v"?ra(a):sa(a)},na=function(e,a){return e==="h"&&a==="rtl"?-1:1},la=function(e,a,r,n,d){var c=na(e,window.getComputedStyle(a).direction),f=c*n,i=r.target,g=a.contains(i),v=!1,C=f>0,N=0,E=0;do{var p=Be(e,i),w=p[0],s=p[1],u=p[2],m=s-u-c*w;(w||m)&&We(e,i)&&(N+=m,E+=w),i=i.parentNode.host||i.parentNode}while(!g&&i!==document.body||g&&(a.contains(i)||a===i));return(C&&(d&&Math.abs(N)<1||!d&&f>N)||!C&&(d&&Math.abs(E)<1||!d&&-f>E))&&(v=!0),v},G=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},ke=function(e){return[e.deltaX,e.deltaY]},Fe=function(e){return e&&"current"in e?e.current:e},oa=function(e,a){return e[0]===a[0]&&e[1]===a[1]},ia=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},ca=0,U=[];function da(e){var a=l.useRef([]),r=l.useRef([0,0]),n=l.useRef(),d=l.useState(ca++)[0],c=l.useState(pt)[0],f=l.useRef(e);l.useEffect(function(){f.current=e},[e]),l.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(d));var s=xt([e.lockRef.current],(e.shards||[]).map(Fe),!0).filter(Boolean);return s.forEach(function(u){return u.classList.add("allow-interactivity-".concat(d))}),function(){document.body.classList.remove("block-interactivity-".concat(d)),s.forEach(function(u){return u.classList.remove("allow-interactivity-".concat(d))})}}},[e.inert,e.lockRef.current,e.shards]);var i=l.useCallback(function(s,u){if("touches"in s&&s.touches.length===2||s.type==="wheel"&&s.ctrlKey)return!f.current.allowPinchZoom;var m=G(s),b=r.current,h="deltaX"in s?s.deltaX:b[0]-m[0],x="deltaY"in s?s.deltaY:b[1]-m[1],j,_=s.target,S=Math.abs(h)>Math.abs(x)?"h":"v";if("touches"in s&&S==="h"&&_.type==="range")return!1;var I=Te(S,_);if(!I)return!0;if(I?j=S:(j=S==="v"?"h":"v",I=Te(S,_)),!I)return!1;if(!n.current&&"changedTouches"in s&&(h||x)&&(n.current=j),!j)return!0;var $=n.current||j;return la($,u,s,$==="h"?h:x,!0)},[]),g=l.useCallback(function(s){var u=s;if(!(!U.length||U[U.length-1]!==c)){var m="deltaY"in u?ke(u):G(u),b=a.current.filter(function(j){return j.name===u.type&&(j.target===u.target||u.target===j.shadowParent)&&oa(j.delta,m)})[0];if(b&&b.should){u.cancelable&&u.preventDefault();return}if(!b){var h=(f.current.shards||[]).map(Fe).filter(Boolean).filter(function(j){return j.contains(u.target)}),x=h.length>0?i(u,h[0]):!f.current.noIsolation;x&&u.cancelable&&u.preventDefault()}}},[]),v=l.useCallback(function(s,u,m,b){var h={name:s,delta:u,target:m,should:b,shadowParent:ua(m)};a.current.push(h),setTimeout(function(){a.current=a.current.filter(function(x){return x!==h})},1)},[]),C=l.useCallback(function(s){r.current=G(s),n.current=void 0},[]),N=l.useCallback(function(s){v(s.type,ke(s),s.target,i(s,e.lockRef.current))},[]),E=l.useCallback(function(s){v(s.type,G(s),s.target,i(s,e.lockRef.current))},[]);l.useEffect(function(){return U.push(c),e.setCallbacks({onScrollCapture:N,onWheelCapture:N,onTouchMoveCapture:E}),document.addEventListener("wheel",g,L),document.addEventListener("touchmove",g,L),document.addEventListener("touchstart",C,L),function(){U=U.filter(function(s){return s!==c}),document.removeEventListener("wheel",g,L),document.removeEventListener("touchmove",g,L),document.removeEventListener("touchstart",C,L)}},[]);var p=e.removeScrollBar,w=e.inert;return l.createElement(l.Fragment,null,w?l.createElement(c,{styles:ia(d)}):null,p?l.createElement(bt,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function ua(e){for(var a=null;e!==null;)e instanceof ShadowRoot&&(a=e.host,e=e.host),e=e.parentNode;return a}const fa=yt(Le,da);var He=l.forwardRef(function(e,a){return l.createElement(J,W({},e,{ref:a,sideCar:fa}))});He.classNames=J.classNames;const ma=He;var Q="Dialog",[$e,Ta]=jt(Q),[ha,D]=$e(Q),qe=e=>{const{__scopeDialog:a,children:r,open:n,defaultOpen:d,onOpenChange:c,modal:f=!0}=e,i=l.useRef(null),g=l.useRef(null),[v,C]=Et({prop:n,defaultProp:d??!1,onChange:c,caller:Q});return t.jsx(ha,{scope:a,triggerRef:i,contentRef:g,contentId:se(),titleId:se(),descriptionId:se(),open:v,onOpenChange:C,onOpenToggle:l.useCallback(()=>C(N=>!N),[C]),modal:f,children:r})};qe.displayName=Q;var Ve="DialogTrigger",Ke=l.forwardRef((e,a)=>{const{__scopeDialog:r,...n}=e,d=D(Ve,r),c=z(a,d.triggerRef);return t.jsx(B.button,{type:"button","aria-haspopup":"dialog","aria-expanded":d.open,"aria-controls":d.contentId,"data-state":be(d.open),...n,ref:c,onClick:V(e.onClick,d.onOpenToggle)})});Ke.displayName=Ve;var pe="DialogPortal",[va,Ye]=$e(pe,{forceMount:void 0}),Ge=e=>{const{__scopeDialog:a,forceMount:r,children:n,container:d}=e,c=D(pe,a);return t.jsx(va,{scope:a,forceMount:r,children:l.Children.map(n,f=>t.jsx(ge,{present:r||c.open,children:t.jsx(St,{asChild:!0,container:d,children:f})}))})};Ge.displayName=pe;var X="DialogOverlay",Xe=l.forwardRef((e,a)=>{const r=Ye(X,e.__scopeDialog),{forceMount:n=r.forceMount,...d}=e,c=D(X,e.__scopeDialog);return c.modal?t.jsx(ge,{present:n||c.open,children:t.jsx(pa,{...d,ref:a})}):null});Xe.displayName=X;var ga=Rt("DialogOverlay.RemoveScroll"),pa=l.forwardRef((e,a)=>{const{__scopeDialog:r,...n}=e,d=D(X,r);return t.jsx(ma,{as:ga,allowPinchZoom:!0,shards:[d.contentRef],children:t.jsx(B.div,{"data-state":be(d.open),...n,ref:a,style:{pointerEvents:"auto",...n.style}})})}),P="DialogContent",ze=l.forwardRef((e,a)=>{const r=Ye(P,e.__scopeDialog),{forceMount:n=r.forceMount,...d}=e,c=D(P,e.__scopeDialog);return t.jsx(ge,{present:n||c.open,children:c.modal?t.jsx(xa,{...d,ref:a}):t.jsx(ba,{...d,ref:a})})});ze.displayName=P;var xa=l.forwardRef((e,a)=>{const r=D(P,e.__scopeDialog),n=l.useRef(null),d=z(a,r.contentRef,n);return l.useEffect(()=>{const c=n.current;if(c)return Ct(c)},[]),t.jsx(Ze,{...e,ref:d,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:V(e.onCloseAutoFocus,c=>{var f;c.preventDefault(),(f=r.triggerRef.current)==null||f.focus()}),onPointerDownOutside:V(e.onPointerDownOutside,c=>{const f=c.detail.originalEvent,i=f.button===0&&f.ctrlKey===!0;(f.button===2||i)&&c.preventDefault()}),onFocusOutside:V(e.onFocusOutside,c=>c.preventDefault())})}),ba=l.forwardRef((e,a)=>{const r=D(P,e.__scopeDialog),n=l.useRef(!1),d=l.useRef(!1);return t.jsx(Ze,{...e,ref:a,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:c=>{var f,i;(f=e.onCloseAutoFocus)==null||f.call(e,c),c.defaultPrevented||(n.current||(i=r.triggerRef.current)==null||i.focus(),c.preventDefault()),n.current=!1,d.current=!1},onInteractOutside:c=>{var g,v;(g=e.onInteractOutside)==null||g.call(e,c),c.defaultPrevented||(n.current=!0,c.detail.originalEvent.type==="pointerdown"&&(d.current=!0));const f=c.target;((v=r.triggerRef.current)==null?void 0:v.contains(f))&&c.preventDefault(),c.detail.originalEvent.type==="focusin"&&d.current&&c.preventDefault()}})}),Ze=l.forwardRef((e,a)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:d,onCloseAutoFocus:c,...f}=e,i=D(P,r),g=l.useRef(null),v=z(a,g);return Qt(),t.jsxs(t.Fragment,{children:[t.jsx(Oe,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:d,onUnmountAutoFocus:c,children:t.jsx(Nt,{role:"dialog",id:i.contentId,"aria-describedby":i.descriptionId,"aria-labelledby":i.titleId,"data-state":be(i.open),...f,ref:v,onDismiss:()=>i.onOpenChange(!1)})}),t.jsxs(t.Fragment,{children:[t.jsx(ya,{titleId:i.titleId}),t.jsx(Ca,{contentRef:g,descriptionId:i.descriptionId})]})]})}),xe="DialogTitle",Je=l.forwardRef((e,a)=>{const{__scopeDialog:r,...n}=e,d=D(xe,r);return t.jsx(B.h2,{id:d.titleId,...n,ref:a})});Je.displayName=xe;var Qe="DialogDescription",et=l.forwardRef((e,a)=>{const{__scopeDialog:r,...n}=e,d=D(Qe,r);return t.jsx(B.p,{id:d.descriptionId,...n,ref:a})});et.displayName=Qe;var tt="DialogClose",at=l.forwardRef((e,a)=>{const{__scopeDialog:r,...n}=e,d=D(tt,r);return t.jsx(B.button,{type:"button",...n,ref:a,onClick:V(e.onClick,()=>d.onOpenChange(!1))})});at.displayName=tt;function be(e){return e?"open":"closed"}var rt="DialogTitleWarning",[ka,st]=wt(rt,{contentName:P,titleName:xe,docsSlug:"dialog"}),ya=({titleId:e})=>{const a=st(rt),r=`\`${a.contentName}\` requires a \`${a.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${a.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${a.docsSlug}`;return l.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},ja="DialogDescriptionWarning",Ca=({contentRef:e,descriptionId:a})=>{const n=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${st(ja).contentName}}.`;return l.useEffect(()=>{var c;const d=(c=e.current)==null?void 0:c.getAttribute("aria-describedby");a&&d&&(document.getElementById(a)||console.warn(n))},[n,e,a]),null},Na=qe,wa=Ke,Ea=Ge,nt=Xe,lt=ze,ot=Je,it=et,Sa=at;const Pe=Na,Ie=wa,Ra=Ea,ct=Z.forwardRef(({className:e,...a},r)=>t.jsx(nt,{ref:r,className:H("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...a}));ct.displayName=nt.displayName;const ue=Z.forwardRef(({className:e,children:a,...r},n)=>t.jsxs(Ra,{children:[t.jsx(ct,{}),t.jsxs(lt,{ref:n,className:H("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[a,t.jsxs(Sa,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[t.jsx(Ae,{className:"h-4 w-4"}),t.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ue.displayName=lt.displayName;const fe=({className:e,...a})=>t.jsx("div",{className:H("flex flex-col space-y-1.5 text-center sm:text-left",e),...a});fe.displayName="DialogHeader";const me=({className:e,...a})=>t.jsx("div",{className:H("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...a});me.displayName="DialogFooter";const he=Z.forwardRef(({className:e,...a},r)=>t.jsx(ot,{ref:r,className:H("text-lg font-semibold leading-none tracking-tight",e),...a}));he.displayName=ot.displayName;const ve=Z.forwardRef(({className:e,...a},r)=>t.jsx(it,{ref:r,className:H("text-sm text-muted-foreground",e),...a}));ve.displayName=it.displayName;const ce=[{value:"client",label:"Client"},{value:"staff_drafter",label:"Staff - Drafter"},{value:"staff_manager",label:"Staff - Manager"},{value:"staff_admin",label:"Staff - Admin"}],Fa=()=>{const{user:e,role:a}=Dt(),{toast:r}=_t(),[n,d]=l.useState([]),[c,f]=l.useState(!0),[i,g]=l.useState(""),[v,C]=l.useState("all"),[N,E]=l.useState(!1),[p,w]=l.useState(null),[s,u]=l.useState({email:"",password:"",full_name:"",role:"client"}),[m,b]=l.useState(!1);l.useEffect(()=>{h()},[]);const h=async()=>{f(!0);try{const{data:o,error:R}=await q.from("profiles").select("*").order("id",{ascending:!1});if(R)throw R;d(o||[])}catch(o){console.error("Error fetching users:",o),r({variant:"destructive",title:"Error",description:"Failed to fetch users: "+o.message})}finally{f(!1)}},x=async()=>{b(!0);try{const{data:o,error:R}=await q.auth.signUp({email:s.email,password:s.password,options:{data:{full_name:s.full_name}}});if(R)throw R;if(o.user){const{error:y}=await q.from("profiles").update({role:s.role,full_name:s.full_name}).eq("id",o.user.id);if(y)throw y}r({title:"Success",description:`User ${s.email} created successfully.`}),E(!1),S(),h()}catch(o){r({variant:"destructive",title:"Error",description:"Failed to create user: "+o.message+". Note: In production, this would require admin privileges via Edge Functions."})}finally{b(!1)}},j=async()=>{if(p){b(!0);try{const{error:o}=await q.from("profiles").update({full_name:s.full_name,role:s.role}).eq("id",p.id);if(o)throw o;r({title:"Success",description:"User updated successfully."}),w(null),S(),h()}catch(o){r({variant:"destructive",title:"Error",description:"Failed to update user: "+o.message})}finally{b(!1)}}},_=async(o,R)=>{if(window.confirm(`Are you sure you want to delete user ${R}? This action cannot be undone.`))try{const{error:y}=await q.from("profiles").update({is_active:!1}).eq("id",o);if(y)throw y;r({title:"Success",description:"User deactivated successfully. Note: Full deletion requires admin privileges."}),h()}catch(y){r({variant:"destructive",title:"Error",description:"Failed to delete user: "+y.message})}},S=()=>{u({email:"",password:"",full_name:"",role:"client"})},I=o=>{w(o),u({email:o.email||"",password:"",full_name:o.full_name||"",role:o.role||"client"})},$=n.filter(o=>{var ye,je;const R=((ye=o.full_name)==null?void 0:ye.toLowerCase().includes(i.toLowerCase()))||((je=o.email)==null?void 0:je.toLowerCase().includes(i.toLowerCase())),y=v==="all"||o.role===v;return R&&y}),dt=o=>{switch(o){case"staff_admin":return"bg-purple-100 text-purple-700 dark:bg-purple-700/30 dark:text-purple-300";case"staff_manager":return"bg-blue-100 text-blue-700 dark:bg-blue-700/30 dark:text-blue-300";case"staff_drafter":return"bg-green-100 text-green-700 dark:bg-green-700/30 dark:text-green-300";case"client":default:return"bg-slate-100 text-slate-700 dark:bg-slate-700/30 dark:text-slate-300"}};return c?t.jsxs("div",{className:"flex flex-col items-center justify-center h-[calc(100vh-250px)]",children:[t.jsx(Tt,{className:"h-16 w-16 text-purple-500 animate-pulse mb-4"}),t.jsx("p",{className:"text-xl text-slate-600 dark:text-slate-300",children:"Loading users..."})]}):t.jsx(kt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:t.jsxs(Ft,{className:"bg-white dark:bg-slate-800 shadow-xl",children:[t.jsx(Pt,{children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(Ne,{className:"h-8 w-8 text-purple-600 dark:text-purple-400"}),t.jsxs("div",{children:[t.jsx(It,{className:"text-2xl text-slate-800 dark:text-slate-100",children:"Manage Users"}),t.jsx(At,{className:"text-slate-600 dark:text-slate-400",children:"Create, edit, and manage user accounts"})]})]}),t.jsxs(Pe,{open:N,onOpenChange:E,children:[t.jsx(Ie,{asChild:!0,children:t.jsxs(k,{className:"bg-gradient-to-r from-purple-600 to-indigo-600 hover:from-purple-700 hover:to-indigo-700 text-white shadow-md",onClick:()=>{S(),w(null)},children:[t.jsx(Ot,{className:"mr-2 h-4 w-4"})," Create User"]})}),t.jsxs(ue,{className:"bg-white dark:bg-slate-800",children:[t.jsxs(fe,{children:[t.jsx(he,{children:"Create New User"}),t.jsx(ve,{children:"Enter the details for the new user account."})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"email",children:"Email"}),t.jsx(A,{id:"email",type:"email",value:s.email,onChange:o=>u({...s,email:o.target.value}),placeholder:"user@example.com",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"password",children:"Password"}),t.jsx(A,{id:"password",type:"password",value:s.password,onChange:o=>u({...s,password:o.target.value}),placeholder:"Minimum 6 characters",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"full_name",children:"Full Name"}),t.jsx(A,{id:"full_name",value:s.full_name,onChange:o=>u({...s,full_name:o.target.value}),placeholder:"John Doe",required:!0})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"role",children:"Role"}),t.jsxs(ee,{value:s.role,onValueChange:o=>u({...s,role:o}),children:[t.jsx(te,{children:t.jsx(ae,{})}),t.jsx(re,{children:ce.map(o=>t.jsx(K,{value:o.value,children:o.label},o.value))})]})]})]}),t.jsxs(me,{children:[t.jsx(k,{variant:"outline",onClick:()=>E(!1),disabled:m,children:"Cancel"}),t.jsx(k,{onClick:x,disabled:m||!s.email||!s.password||!s.full_name,className:"bg-purple-600 hover:bg-purple-700 text-white",children:m?"Creating...":"Create User"})]})]})]})]})}),t.jsxs(Mt,{children:[t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[t.jsxs("div",{className:"relative flex-grow",children:[t.jsx(Lt,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-slate-400"}),t.jsx(A,{placeholder:"Search by name or email...",value:i,onChange:o=>g(o.target.value),className:"pl-10"})]}),t.jsxs(ee,{value:v,onValueChange:C,children:[t.jsx(te,{className:"w-full md:w-[200px]",children:t.jsx(ae,{placeholder:"Filter by role"})}),t.jsxs(re,{children:[t.jsx(K,{value:"all",children:"All Roles"}),ce.map(o=>t.jsx(K,{value:o.value,children:o.label},o.value))]})]})]}),$.length===0?t.jsxs("div",{className:"text-center py-10",children:[t.jsx(Ne,{className:"mx-auto h-12 w-12 text-slate-400 mb-4"}),t.jsx("p",{className:"text-slate-500",children:"No users found matching your criteria."})]}):t.jsx("div",{className:"overflow-x-auto",children:t.jsxs(Ut,{children:[t.jsx(Wt,{children:t.jsxs(we,{children:[t.jsx(O,{children:"Name"}),t.jsx(O,{children:"Email"}),t.jsx(O,{children:"Role"}),t.jsx(O,{children:"Status"}),t.jsx(O,{children:"User ID"}),t.jsx(O,{children:"Actions"})]})}),t.jsx(Bt,{children:$.map(o=>{var R;return t.jsxs(we,{children:[t.jsx(M,{className:"font-medium",children:o.full_name||"N/A"}),t.jsx(M,{children:o.email||"N/A"}),t.jsx(M,{children:t.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${dt(o.role)}`,children:((R=o.role)==null?void 0:R.replace(/_/g," ").replace(/\b\w/g,y=>y.toUpperCase()))||"Client"})}),t.jsx(M,{children:o.is_active!==!1?t.jsxs("span",{className:"flex items-center text-green-600 dark:text-green-400",children:[t.jsx(Ht,{className:"h-4 w-4 mr-1"})," Active"]}):t.jsxs("span",{className:"flex items-center text-red-600 dark:text-red-400",children:[t.jsx(Ae,{className:"h-4 w-4 mr-1"})," Inactive"]})}),t.jsx(M,{className:"text-xs text-slate-600 dark:text-slate-400",children:o.id}),t.jsx(M,{children:t.jsxs("div",{className:"flex space-x-1",children:[t.jsxs(Pe,{open:(p==null?void 0:p.id)===o.id,onOpenChange:y=>!y&&w(null),children:[t.jsx(Ie,{asChild:!0,children:t.jsx(k,{variant:"outline",size:"icon",onClick:()=>I(o),disabled:o.id===(e==null?void 0:e.id),className:"h-8 w-8",children:t.jsx(Vt,{className:"h-4 w-4"})})}),t.jsxs(ue,{className:"bg-white dark:bg-slate-800",children:[t.jsxs(fe,{children:[t.jsx(he,{children:"Edit User"}),t.jsxs(ve,{children:["Update user information for ",o.email]})]}),t.jsxs("div",{className:"space-y-4 py-4",children:[t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"edit_email",children:"Email"}),t.jsx(A,{id:"edit_email",type:"email",value:s.email,disabled:!0,className:"bg-slate-100 dark:bg-slate-700"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"edit_full_name",children:"Full Name"}),t.jsx(A,{id:"edit_full_name",value:s.full_name,onChange:y=>u({...s,full_name:y.target.value}),placeholder:"John Doe"})]}),t.jsxs("div",{className:"space-y-2",children:[t.jsx(F,{htmlFor:"edit_role",children:"Role"}),t.jsxs(ee,{value:s.role,onValueChange:y=>u({...s,role:y}),children:[t.jsx(te,{children:t.jsx(ae,{})}),t.jsx(re,{children:ce.map(y=>t.jsx(K,{value:y.value,children:y.label},y.value))})]})]})]}),t.jsxs(me,{children:[t.jsx(k,{variant:"outline",onClick:()=>w(null),disabled:m,children:"Cancel"}),t.jsx(k,{onClick:j,disabled:m,className:"bg-purple-600 hover:bg-purple-700 text-white",children:m?"Updating...":"Update User"})]})]})]}),t.jsx(k,{variant:"outline",size:"icon",onClick:()=>_(o.id,o.email),disabled:o.id===(e==null?void 0:e.id)||a!=="staff_admin",className:"h-8 w-8 hover:border-red-500 hover:text-red-500",children:t.jsx($t,{className:"h-4 w-4"})})]})})]},o.id)})})]})}),t.jsx("div",{className:"mt-6 p-4 bg-yellow-100 dark:bg-yellow-700/30 rounded-lg",children:t.jsxs("div",{className:"flex items-start space-x-2",children:[t.jsx(qt,{className:"h-5 w-5 text-yellow-600 dark:text-yellow-400 mt-0.5"}),t.jsxs("div",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:[t.jsx("p",{className:"font-semibold",children:"Note:"}),t.jsx("p",{children:"User creation and deletion require admin privileges through Supabase Edge Functions. This demo shows the UI structure, but in production, these operations would be handled securely server-side."})]})]})})]})]})})};export{Fa as default};
